function InlinePlayer(){var a=this;var c=this;var d=soundManager;var b=(navigator.userAgent.match(/msie/i));this.playableClass="inline-playable";this.excludeClass="inline-exclude";this.links=[];this.sounds=[];this.soundsByURL=[];this.indexByURL=[];this.lastSound=null;this.soundCount=0;this.config={playNext:false,autoPlay:false};this.css={sDefault:"sm2_link",sLoading:"sm2_loading",sPlaying:"sm2_playing",sPaused:"sm2_paused"};this.addEventHandler=(typeof window.addEventListener!=="undefined"?function(g,f,e){return g.addEventListener(f,e,false)}:function(g,f,e){g.attachEvent("on"+f,e)});this.removeEventHandler=(typeof window.removeEventListener!=="undefined"?function(g,f,e){return g.removeEventListener(f,e,false)}:function(g,f,e){return g.detachEvent("on"+f,e)});this.classContains=function(f,e){return(typeof(f.className)!="undefined"?f.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)")):false)};this.addClass=function(f,e){if(!f||!e||a.classContains(f,e)){return false}f.className=(f.className?f.className+" ":"")+e};this.removeClass=function(f,e){if(!f||!e||!a.classContains(f,e)){return false}f.className=f.className.replace(new RegExp("( "+e+")|("+e+")","g"),"")};this.getSoundByURL=function(e){return(typeof a.soundsByURL[e]!="undefined"?a.soundsByURL[e]:null)};this.isChildOfNode=function(f,e){if(!f||!f.parentNode){return false}e=e.toLowerCase();do{f=f.parentNode}while(f&&f.parentNode&&f.nodeName.toLowerCase()!=e);return(f.nodeName.toLowerCase()==e?f:null)};this.events={play:function(){var e=$(this._data.oLink).parent("li");e.removeClass(this._data.className);this._data.className=c.css.sPlaying;e.addClass(this._data.className)},stop:function(){var e=$(this._data.oLink).parent("li");e.removeClass(this._data.className);this._data.className=""},pause:function(){var e=$(this._data.oLink).parent("li");e.removeClass(this._data.className);this._data.className=c.css.sPaused;e.addClass(this._data.className)},resume:function(){var e=$(this._data.oLink).parent("li");e.removeClass(this._data.className);this._data.className=c.css.sPlaying;e.addClass(this._data.className)},finish:function(){var f=$(this._data.oLink).parent("li");f.removeClass(this._data.className);this._data.className="";if(c.config.playNext){var e=(c.indexByURL[this._data.oLink.href]+1);if(e<c.links.length){c.handleClick({target:c.links[e]})}}}};this.stopEvent=function(f){if(typeof f!="undefined"&&typeof f.preventDefault!="undefined"){f.preventDefault()}else{if(typeof event!="undefined"&&typeof event.returnValue!="undefined"){event.returnValue=false}}return false};this.getTheDamnLink=(b)?function(f){return(f&&f.target?f.target:window.event.srcElement)}:function(f){return f.target};this.handleClick=function(h){if(typeof h.button!="undefined"&&h.button>1){return true}var j=a.getTheDamnLink(h);if(j.nodeName.toLowerCase()!="a"){j=a.isChildOfNode(j,"a");if(!j){return true}}var g=j.getAttribute("href");if(!j.href||(!d.canPlayLink(j)&&!a.classContains(j,a.playableClass))||a.classContains(j,a.excludeClass)){return true}var i=(j.href);var f=a.getSoundByURL(i);if(f){if(f==a.lastSound){f.togglePause()}else{d._writeDebug("sound different than last sound: "+a.lastSound.sID);if(a.lastSound){a.stopSound(a.lastSound)}f.togglePause()}}else{if(a.lastSound){a.stopSound(a.lastSound)}f=d.createSound({id:"inlineMP3Sound"+(a.soundCount++),url:i,onplay:a.events.play,onstop:a.events.stop,onpause:a.events.pause,onresume:a.events.resume,onfinish:a.events.finish});f._data={oLink:j,className:a.css.sPlaying};a.soundsByURL[i]=f;a.sounds.push(f);f.play()}a.lastSound=f;if(typeof h!="undefined"&&typeof h.preventDefault!="undefined"){h.preventDefault()}else{event.returnValue=false}return false};this.stopSound=function(e){soundManager.stop(e.sID);soundManager.unload(e.sID)};this.init=function(){d._writeDebug("inlinePlayer.init()");var h=document.getElementsByTagName("a");var g=0;for(var f=0,e=h.length;f<e;f++){if((d.canPlayLink(h[f])||a.classContains(h[f],a.playableClass))&&!a.classContains(h[f],a.excludeClass)){a.addClass(h[f],a.css.sDefault);a.links[g]=(h[f]);a.indexByURL[h[f].href]=g;g++}}if(g>0){a.addEventHandler(document,"click",a.handleClick);if(a.config.autoPlay){a.handleClick({target:a.links[0],preventDefault:function(){}})}}d._writeDebug("inlinePlayer.init(): Found "+g+" relevant items.")};this.init()}var inlinePlayer=null;soundManager.debugMode=true;soundManager.preferFlash=false;soundManager.useFlashBlock=true;soundManager.url="../../swf/";soundManager.flashVersion=9;soundManager.onready(function(){inlinePlayer=new InlinePlayer()});